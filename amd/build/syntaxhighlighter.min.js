define("filter_githubcode/syntaxhighlighter",["jquery"],(function($){function splitByRegex(segs,re,cls){let out=[];return segs.forEach((s=>{if(s.cls)return void out.push(s);let m,text=s.html,last=0;for(re.lastIndex=0;null!==(m=re.exec(text));)m.index>last&&out.push({html:text.slice(last,m.index),cls:null}),out.push({html:m[0],cls:cls}),last=re.lastIndex;last<text.length&&out.push({html:text.slice(last),cls:null})})),out}return{init:function(){$("code.githubcode").each((function(){let extractedCode=function($block){let code=$block.first();if(0===code.length)return null;let attrs={};return $.each(code.prop("attributes"),(function(){"class"!==this.name&&(attrs[this.name]=this.value)})),{code:code.text(),classes:code.attr("class")||"",attrs:attrs}}($(this));if(!extractedCode)return;let langname=extractedCode.attrs["data-lang"]||"txt";require(["filter_githubcode/"+langname],function(lang_data){if(!lang_data)return;extractedCode.attrs["data-lang"]=lang_data.langname||langname;let segs=[{html:(raw=extractedCode.code,$("<div>").text(raw).html()),cls:null}];var raw;for(let i=0;i<lang_data.multicomment.length;i+=2){let open=lang_data.multicomment[i],close=lang_data.multicomment[i+1];segs=splitByRegex(segs,new RegExp(open+"[\\s\\S]*?"+close,"g"),"comment")}segs=splitByRegex(segs,new RegExp("("+lang_data.comment.join("|")+".*)","g"),"comment");let artx=lang_data.text.map((el=>"\\"+el+"[\\s\\S]*?\\"+el));segs=splitByRegex(segs,new RegExp("("+artx.join("|")+")","g"),"string");for(let k in lang_data.keywords){let flags=lang_data.casesensitive[k]?"g":"gi";segs=splitByRegex(segs,new RegExp("\\b("+lang_data.keywords[k].join("|")+")\\b",flags),"keyword-"+k)}segs=splitByRegex(segs,new RegExp("\\b("+lang_data.number+")\\b","g"),"dec-number");let safeCode=segs.map((s=>s.cls?"<span class='".concat(s.cls,"'>").concat(s.html,"</span>"):s.html)).join("");safeCode=safeCode.replace(/<span class='(comment|string)'>([\s\S]*?)<\/span>/g,((_,cls,content)=>content.split("\n").map((part=>"<span class='".concat(cls,"'>").concat(part,"</span>"))).join("\n")));let parsedCode=function(code){let lines=code.replace(/\n$/,"").split("\n"),newCode="";return lines.forEach((function(line){newCode+="<span class='line'>"+line+"</span>\n"})),newCode}(safeCode),newCode=function(code,classes,attrs){let container=$("<div>").addClass("githubcode-container").addClass(attrs["data-theme"]?"githubcode-"+attrs["data-theme"]:"light").toggleClass("lines-off",0==attrs["data-linenumbers"]).toggleClass("zebra-on",1==attrs["data-zebrastyle"]),header=$("<div>").addClass("githubcode-header").append($("<span>").addClass("language").text(attrs["data-lang"]||"Plain Text")).append($("<span>").addClass("title").text(attrs["data-title"]||"")).append($("<span>").addClass("github-link").attr("title","GithubCodeFilter on GitHub").html($("<a>").attr("href","https://github.com/November7/GitHubCodeFilter").attr("target","_blank").attr("rel","noopener noreferrer").append($("<i>").addClass("fab fa-github")))),codeBlock=$("<pre>").append($("<code>").attr("class",classes).html(code)),footer=$("<div>").addClass("githubcode-footer").append($("<span>").addClass("zebra-toggle").attr("title","Toggle zebra-style").on("click",(function(){$(this).closest(".githubcode-container").toggleClass("zebra-on")})).append($("<i>").addClass("fa-solid fa-grip-lines"))).append($("<span>").addClass("lines-toggle").attr("title","Toggle line numbers").on("click",(function(){$(this).closest(".githubcode-container").toggleClass("lines-off")})).append($("<i>").addClass("fa-solid fa-1"))).append($("<span>").addClass("cache-icon").attr("title","Code fetched from github.com "+attrs["data-age"]+" seconds ago").append($("<i>").addClass("fa-regular fa-clock")).on("click",(function(){let $icon=$(this),text=$icon.attr("title"),$label=$icon.find(".cache-label");$label.length?$label.remove():$icon.append($("<span>").addClass("cache-label").css({"margin-left":"6px"}).text(text))}))).append($("<span>").addClass("source-link").html($("<a>").attr("href",attrs["data-href"]||"#").attr("target","_blank").attr("rel","noopener noreferrer").append($("<i>").addClass("fa-solid fa-anchor"))));return container.append(header,codeBlock,footer),container}(parsedCode,extractedCode.classes,extractedCode.attrs);$(this).replaceWith(newCode)}.bind(this))}))}}}));

//# sourceMappingURL=syntaxhighlighter.min.js.map
{"version":3,"file":"syntaxhighlighter.min.js","sources":["../src/syntaxhighlighter.js"],"sourcesContent":["// AMD module for syntax highlighter\n// ver: 4.0 [2025.12.06] moving to new repo\n// ver: 4.1 [2025.12.08] stable release (version 1.0.0) ->\n// ver: 1.0.0 [2025.12.08] change versioning scheme (compatible with plugin versioning)\n\ndefine(['jquery'], function($) {\n    /**\n    * Escapuje znaki specjalne HTML.\n    * @param {string} raw - surowy kod\n    * @returns {string} - kod z encjami (&lt;, &gt;, &amp;)\n    */\n    function escape(raw) {\n        return $(\"<div>\").text(raw).html();\n    }\n\n    /**\n    * Code & params extractor\n    * @param {jQuery} $block - jQuery object containing the code block\n    * @returns {Object} - Extracted code and parameters\n    */\n    function extract($block) {\n        let code = $block.first();\n        if(code.length === 0) {\n            return null;\n        }\n\n        let attrs = {};\n        $.each(code.prop(\"attributes\"), function() {\n            if (this.name !== \"class\") {\n                attrs[this.name] = this.value;\n            }\n        });\n        return {\n            code: code.text(),\n            classes: code.attr(\"class\") || \"\",\n            attrs: attrs\n        };\n    }\n\n    /**\n    * Podmienia zawartość <pre> na finalny <code>:\n    * @param {Object} code - kod do sparsowania\n    * @param {Object} classes - klasy do dodania do elementu code\n    * @param {Object} attrs - atrybuty do dodania w nagłówku i stopce\n    * @returns {string} newCode - sparsowany kod\n    */\n    function final(code, classes, attrs) {\n        let container = $(\"<div>\")\n            .addClass(\"githubcode-container\")\n            .addClass(attrs['data-theme'] ? \"githubcode-\" + attrs['data-theme'] : \"light\")\n            .toggleClass(\"lines-off\", attrs['data-linenumbers']);\n\n        let header = $(\"<div>\")\n            .addClass(\"githubcode-header\")            \n            .append(\n                $(\"<span>\")\n                    .addClass(\"language\")\n                    .text(attrs['data-lang'] || \"Plain Text\")\n                )\n            .append(\n                $(\"<span>\")\n                    .addClass(\"title\")\n                    .text(attrs['data-title'] || \"\")\n                )\n            .append(\n                $(\"<span>\")\n                .addClass(\"github-link\")\n                .attr(\"title\", \"GithubCodeFilter on GitHub\")\n                .html(\n                    $(\"<a>\")\n                        .attr(\"href\", 'https://github.com/November7/GitHubCodeFilter' || \"#\")\n                        .attr(\"target\", \"_blank\")\n                        .attr(\"rel\", \"noopener noreferrer\")\n                        .append($(\"<i>\").addClass(\"fab fa-github\"))\n                    )\n                );\n\n        let codeBlock = $(\"<pre>\").append(\n            $(\"<code>\")\n                .attr(\"class\", classes)\n                .html(code)\n        );\n\n        let footer = $(\"<div>\")\n            .addClass(\"githubcode-footer\")\n            .append(\n                $(\"<span>\")\n                    .addClass(\"zebra-toggle\")\n                    .attr(\"title\", \"Toggle zebra-style\")\n                    .on(\"click\", function() {\n                        $(this).closest(\".githubcode-container\").toggleClass(\"zebra-on\");\n                    })\n                    .append($(\"<i>\").addClass(\"fa-solid fa-grip-lines\"))                    \n            )\n            .append(\n                $(\"<span>\")\n                    .addClass(\"lines-toggle\")\n                    .attr(\"title\", \"Toggle line numbers\")\n                    .on(\"click\", function() {\n                        $(this).closest(\".githubcode-container\").toggleClass(\"lines-off\");\n                    })\n                    .append($(\"<i>\").addClass(\"fa-solid fa-1\"))\n            )\n            .append(\n                $(\"<span>\")\n                    .addClass(\"cache-icon\")\n                    .attr(\"title\", \"Code fetched from github.com \" + attrs['data-age'] + \" seconds ago\")\n                    .append(\n                        $(\"<i>\").addClass(\"fa-regular fa-clock\")\n                    )\n                    .on(\"click\", function() {\n                        let $icon = $(this);\n                        let text = $icon.attr(\"title\");\n                        let $label = $icon.find(\".cache-label\");\n                        if ($label.length) {\n                            $label.remove();\n                        } else {\n                            $icon.append(\n                                $(\"<span>\")\n                                    .addClass(\"cache-label\")\n                                    .css({\"margin-left\":\"6px\"})\n                                    .text(text)\n                            );\n                        }\n                    })\n            )\n            .append(\n                $(\"<span>\")\n                    .addClass(\"source-link\")\n                    .html(\n                        $(\"<a>\")\n                            .attr(\"href\", attrs['data-href'] || \"#\")\n                            .attr(\"target\", \"_blank\")\n                            .attr(\"rel\", \"noopener noreferrer\")\n                            .append($(\"<i>\").addClass(\"fa-solid fa-anchor\"))\n                    )\n            );\n            \n        container.append(header, codeBlock,  footer);\n        return container;\n    }\n\n    /**\n    * Dzieli kod na linie i opakowuje każdą linię w span.line:\n    * @param {Object} code - kod do sparsowania\n    * @returns {string} newCode - sparsowany kod\n    */\n    function lines(code) {\n        let lines = code.replace(/\\n$/, \"\").split(\"\\n\");\n        let newCode = \"\";\n        lines.forEach(function(line) {\n            newCode += \"<span class='line'>\" +  line + \"</span>\\n\";\n        });\n        return newCode;\n    }\n\n    /**\n    * Podział wg regexów i nadanie klas:\n    * @param {Object} segs - kod do sparsowania\n    * @param {Object} re - regex do podziału\n    * @param {string} cls - klasa do nadania\n    * @returns {string} newCode - sparsowany kod\n    */\n    function splitByRegex(segs, re, cls) {\n        let out = [];\n        segs.forEach(s => {\n            if (s.cls) { out.push(s); return; }\n            let text = s.html;\n            let last = 0;\n            re.lastIndex = 0;\n            let m;\n            while ((m = re.exec(text)) !== null) {\n                if (m.index > last) {out.push({ html: text.slice(last, m.index), cls: null });}\n                out.push({ html: m[0], cls: cls });\n                last = re.lastIndex;\n            }\n            if (last < text.length) {out.push({ html: text.slice(last), cls: null });}\n        });\n        return out;\n    }\n\n    return {\n        init: function() {\n            $(\"code.githubcode\").each(function() {\n                let extractedCode = extract($(this));\n                if (!extractedCode) {return;}\n                let langname = extractedCode.attrs['data-lang'] || 'txt';\n\n                require(['filter_githubcode/' + langname], function(lang_data) {\n                    if (!lang_data) {return;}\n                    extractedCode.attrs['data-lang'] = lang_data.langname || langname;\n                    let segs = [{ html: escape(extractedCode.code), cls: null }];\n\n                    //fix multi-line comments\n                    for (let i = 0; i < lang_data.multicomment.length; i += 2) {\n                        let open = lang_data.multicomment[i];\n                        let close = lang_data.multicomment[i + 1];\n                        let re = new RegExp(open + \"[\\\\s\\\\S]*?\" + close, \"g\");\n                        segs = splitByRegex(segs, re, \"comment\");\n                    }\n\n                    segs = splitByRegex(segs, new RegExp(\"(\" + lang_data.comment.join(\"|\") + \".*)\", \"g\"), \"comment\");\n                    \n                    //fix\n                    let artx = lang_data.text.map(el => \"\\\\\" + el + \"[\\\\s\\\\S]*?\\\\\" + el);\n\n                    let regtx = new RegExp(\"(\" + artx.join(\"|\") + \")\", \"g\");\n                    segs = splitByRegex(segs, regtx, \"string\");\n\n                    for (let k in lang_data.keywords) {\n                        let flags = lang_data.casesensitive[k] ? \"g\" : \"gi\";\n                        let re = new RegExp(\"\\\\b(\" + lang_data.keywords[k].join(\"|\") + \")\\\\b\", flags);\n                        segs = splitByRegex(segs, re, \"keyword-\" + k);\n                    }\n                    \n                    let regNum = new RegExp(\"\\\\b(\" + lang_data.number + \")\\\\b\", \"g\");\n                    segs = splitByRegex(segs, regNum, \"dec-number\");\n\n                    //fix\n                    let safeCode = segs.map(s => s.cls ? `<span class='${s.cls}'>${s.html}</span>` : s.html).join(\"\");\n                    safeCode = safeCode.replace(/<span class='(comment|string)'>([\\s\\S]*?)<\\/span>/g,\n                        (_, cls, content) => {\n                            return content.split(\"\\n\")\n                            .map(part => `<span class='${cls}'>${part}</span>`)\n                            .join(\"\\n\");\n                        }\n                    );\n                    let parsedCode = lines(safeCode);\n                    let newCode = final(parsedCode, extractedCode.classes, extractedCode.attrs);\n                    $(this).replaceWith(newCode);\n                }.bind(this));\n            });\n        }\n    };\n});"],"names":["define","$","splitByRegex","segs","re","cls","out","forEach","s","push","m","text","html","last","lastIndex","exec","index","slice","length","init","each","extractedCode","$block","code","first","attrs","prop","this","name","value","classes","attr","extract","langname","require","lang_data","raw","i","multicomment","open","close","RegExp","comment","join","artx","map","el","k","keywords","flags","casesensitive","number","safeCode","replace","_","content","split","part","parsedCode","lines","newCode","line","container","addClass","toggleClass","header","append","codeBlock","footer","on","closest","$icon","$label","find","remove","css","final","replaceWith","bind"],"mappings":"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"}
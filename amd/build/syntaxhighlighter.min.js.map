{"version":3,"file":"syntaxhighlighter.min.js","sources":["../src/syntaxhighlighter.js"],"sourcesContent":["// AMD module for syntax highlighter\n// ver: 4.0 [2025.12.06] moving to new repo\n\ndefine(['jquery'], function($) {\n\n    /**\n    * Escapuje znaki specjalne HTML.\n    * @param {string} raw - surowy kod\n    * @returns {string} - kod z encjami (&lt;, &gt;, &amp;)\n    */\n    function escape(raw) {\n        return $(\"<div>\").text(raw).html();\n    }\n\n    /**\n    * Code & params extractor\n    * @param {jQuery} $block - jQuery object containing the code block\n    * @returns {Object} - Extracted code and parameters\n    */\n    function extract($block) {\n        let code = $block.first();\n        if(code.length === 0) {\n            return null;\n        }\n\n        let attrs = {};\n        $.each(code.prop(\"attributes\"), function() {\n            if (this.name !== \"class\") {\n                attrs[this.name] = this.value;\n            }\n        });\n        return {\n            code: code.text(),\n            classes: code.attr(\"class\") || \"\",\n            attrs: attrs\n        };\n    }\n\n    /**\n    * Podmienia zawartość <pre> na finalny <code>:\n    * @param {Object} code - kod do sparsowania\n    * @param {Object} classes - klasy do dodania do elementu code\n    * @param {Object} attrs - atrybuty do dodania w nagłówku i stopce\n    * @returns {string} newCode - sparsowany kod\n    */\n    function final(code, classes, attrs) {\n        let container = $(\"<div>\")\n            .addClass(\"githubcode-container\")\n            .addClass(attrs['data-theme'] ? \"githubcode-\" + attrs['data-theme'] : \"light\");\n\n        let header = $(\"<div>\")\n            .addClass(\"githubcode-header\")            \n            .append(\n                $(\"<span>\")\n                    .addClass(\"language\")\n                    .text(attrs['data-lang'] || \"Plain Text\")\n                )\n            .append(\n                $(\"<span>\")\n                    .addClass(\"title\")\n                    .text(attrs['data-title'] || \"\")\n                )\n            .append(\n                $(\"<span>\")\n                .addClass(\"github-link\")\n                .attr(\"title\", \"GithubCodeFilter on GitHub\")\n                .html(\n                    $(\"<a>\")\n                        .attr(\"href\", 'https://github.com/November7/GitHubCodeFilter' || \"#\")\n                        .attr(\"target\", \"_blank\")\n                        .attr(\"rel\", \"noopener noreferrer\")\n                        .append($(\"<i>\").addClass(\"fab fa-github\"))\n                    )\n                );\n\n        let codeBlock = $(\"<pre>\").append(\n            $(\"<code>\")\n                .attr(\"class\", classes)\n                .html(code)\n        );\n\n        let footer = $(\"<div>\")\n            .addClass(\"githubcode-footer\")\n            .append(\n                $(\"<span>\")\n                    .addClass(\"zebra-toggle\")\n                    .attr(\"title\", \"Toggle zebra-style\")\n                    .on(\"click\", function() {\n                        $(this).closest(\".githubcode-container\").toggleClass(\"zebra-on\");\n                    })\n                    .append($(\"<i>\").addClass(\"fa-solid fa-grip-lines\"))                    \n            )\n            .append(\n                $(\"<span>\")\n                    .addClass(\"lines-toggle\")\n                    .attr(\"title\", \"Toggle line numbers\")\n                    .on(\"click\", function() {\n                        $(this).closest(\".githubcode-container\").toggleClass(\"lines-off\");\n                    })\n                    .append($(\"<i>\").addClass(\"fa-solid fa-1\"))\n            )\n            .append(\n                $(\"<span>\")\n                    .addClass(\"cache-icon\")\n                    .attr(\"title\", \"Code fetched from github.com \" + attrs['data-age'] + \" seconds ago\")\n                    .append(\n                        $(\"<i>\").addClass(\"fa-regular fa-clock\")\n                    )\n                    .on(\"click\", function() {\n                        let $icon = $(this);\n                        let text = $icon.attr(\"title\");\n                        let $label = $icon.find(\".cache-label\");\n                        if ($label.length) {\n                            $label.remove();\n                        } else {\n                            $icon.append(\n                                $(\"<span>\")\n                                    .addClass(\"cache-label\")\n                                    .css({\"margin-left\":\"6px\"})\n                                    .text(text)\n                            );\n                        }\n                    })\n            )\n            .append(\n                $(\"<span>\")\n                    .addClass(\"source-link\")\n                    .html(\n                        $(\"<a>\")\n                            .attr(\"href\", attrs['data-href'] || \"#\")\n                            .attr(\"target\", \"_blank\")\n                            .attr(\"rel\", \"noopener noreferrer\")\n                            .append($(\"<i>\").addClass(\"fa-solid fa-anchor\"))\n                    )\n            );\n            \n\n        container.append(header, codeBlock,  footer);\n        return container;\n    }\n\n    /**\n    * Dzieli kod na linie i opakowuje każdą linię w span.line:\n    * @param {Object} code - kod do sparsowania\n    * @returns {string} newCode - sparsowany kod\n    */\n    function lines(code) {\n        let lines = code.replace(/\\n$/, \"\").split(\"\\n\");\n        let newCode = \"\";\n        lines.forEach(function(line) {\n            newCode += \"<span class='line'>\" +  line + \"</span>\\n\";\n        });\n        return newCode;\n    }\n\n    /**\n    * Podział wg regexów i nadanie klas:\n    * @param {Object} segs - kod do sparsowania\n    * @param {Object} re - regex do podziału\n    * @param {string} cls - klasa do nadania\n    * @returns {string} newCode - sparsowany kod\n    */\n    function splitByRegex(segs, re, cls) {\n        let out = [];\n        segs.forEach(s => {\n            if (s.cls) { out.push(s); return; }\n            let text = s.html;\n            let last = 0;\n            re.lastIndex = 0;\n            let m;\n            while ((m = re.exec(text)) !== null) {\n                if (m.index > last) {out.push({ html: text.slice(last, m.index), cls: null });}\n                out.push({ html: m[0], cls: cls });\n                last = re.lastIndex;\n            }\n            if (last < text.length) {out.push({ html: text.slice(last), cls: null });}\n        });\n        return out;\n    }\n\n    return {\n        init: function() {\n            $(\"code.githubcode\").each(function() {\n                let extractedCode = extract($(this));\n                if (!extractedCode) {return;}\n                let langname = extractedCode.attrs['data-lang'] || 'txt';\n\n                require(['filter_githubcode/' + langname], function(lang_data) {\n                    if (!lang_data) {return;}\n                    extractedCode.attrs['data-lang'] = lang_data.langname || langname;\n                    let segs = [{ html: escape(extractedCode.code), cls: null }];\n\n                    segs = splitByRegex(segs, new RegExp(\"(\" + lang_data.comment.join(\"|\") + \".*)\", \"g\"), \"comment\");\n                    for (let i = 0; i < lang_data.multicomment.length; i += 2) {\n                        let re = new RegExp(lang_data.multicomment[i] + \".*?\" + lang_data.multicomment[i+1], \"gs\");\n                        segs = splitByRegex(segs, re, \"comment\");\n                    }\n\n                    let artx = lang_data.text.map(el => \"\\\\\"+el+\".*?\\\\\"+el);\n                    let regtx = new RegExp(\"(\" + artx.join(\"|\") + \")\", \"g\");\n                    segs = splitByRegex(segs, regtx, \"string\");\n\n                    for (let k in lang_data.keywords) {\n                        let re = new RegExp(\"\\\\b(\" + lang_data.keywords[k].join(\"|\") + \n                        \")\\\\b\", lang_data.casesensitive[k] ? \"g\" : \"gi\");\n                        segs = splitByRegex(segs, re, \"keyword-\"+k);\n                    }\n                    \n                    let regNum = new RegExp(\"\\\\b(\" + lang_data.number + \")\\\\b\", \"g\");\n                    segs = splitByRegex(segs, regNum, \"dec-number\");\n\n                    let safeCode = segs.map(s => s.cls ? `<span class='${s.cls}'>${s.html}</span>` : s.html).join(\"\");\n\n                    let parsedCode = lines(safeCode);\n                    let newCode = final(parsedCode, extractedCode.classes, extractedCode.attrs);\n                    $(this).replaceWith(newCode); \n\n                }.bind(this));\n            });\n        }\n    };\n});\n"],"names":["define","$","splitByRegex","segs","re","cls","out","forEach","s","push","m","text","html","last","lastIndex","exec","index","slice","length","init","each","extractedCode","$block","code","first","attrs","prop","this","name","value","classes","attr","extract","langname","require","lang_data","raw","RegExp","comment","join","i","multicomment","artx","map","el","k","keywords","casesensitive","number","parsedCode","lines","replace","split","newCode","line","container","addClass","header","append","codeBlock","footer","on","closest","toggleClass","$icon","$label","find","remove","css","final","replaceWith","bind"],"mappings":"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"}